<h2>Users</h2>

<div style="margin: 12px 0; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
    <button (click)="refresh()" [disabled]="busy">Refresh</button>

    <button (click)="blockSelected()" [disabled]="busy || selectedCount === 0">Block</button>
    <button (click)="unblockSelected()" [disabled]="busy || selectedCount === 0">Unblock</button>
    <button (click)="deleteSelected()" [disabled]="busy || selectedCount === 0">Delete</button>

    <button (click)="deleteUnverified()" [disabled]="busy || selectedCount === 0">Delete Unverified</button>

    <span style="margin-left: auto;">Selected: {{ selectedCount }} </span>
</div>

@if (message) {
    <p>{{ message }}</p>
}

<table border="1" [cellPadding]="8" [cellSpacing]="0" style="width: 100%; border-collapse: collapse;">
    <thead>
        <tr>
            <th style="width: 40px;">
                <input
                type="checkbox"
                [checked]="list.length > 0 && selectedCount === list.length"
                (change)="togleAll($any($event.target).checked)"
                />
            </th>
            <th>Name</th>
            <th>Email</th>
            <th>Status</th>
            <th>Created</th>
            <th>Last Login</th>
        </tr>
    </thead>

    <tbody>
        @for (u of list; track u.id) {
            <tr>
                <td>
                    <input
                    type="checkbox"
                    [checked]="isSelected(u.id)"
                    (change)="toggleOne(u.id, $any($event.target).checked)"
                    />
                </td>
                <td>{{ u.name }}</td>
                <td>{{ u.email }}</td>
                <td>{{ u.status }}</td>
                <td>{{ u.createdAtUtc ?? '-' }}</td>
                <td>{{ u.lastLoginAtUtc ?? '-' }}</td>
            </tr>
        }
    </tbody>
</table>